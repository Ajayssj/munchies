<div class="company_wrapper">
  <div class="container-fluid">
    <ul class="nav nav-tabs">
      <li [ngClass]="{'active': view == 'company'}" (click)="changeView('company')"><a>Company</a></li>
      <li [ngClass]="{'active': view == 'types'}" (click)="changeView('types')"><a>Types</a></li>
      <li [ngClass]="{'active': view == 'product'}" (click)="changeView('product')"><a>Product</a></li>
    </ul>
  </div>
  <modal #addModal [closeOnEscape]="false" [closeOnOutsideClick]="false">
    <modal-header>
      <h3>modal that cannot be simply closed</h3>
    </modal-header>
    <modal-content>
      <form *ngIf="view=='company'" [formGroup]="addProductCompanyForm" (ngSubmit)="onSubmit(addModal, 'company')">
        <div class="form-group">
          <label class="control-label">Company</label>
          <input type="text" class="form-control" formControlName="productCompany" placeholder="Enter Product Company" />
        </div>
        <button class="btn btn-primary">Add Company</button>
      </form>
      <form *ngIf="view=='types'" [formGroup]="addProductTypeForm" (ngSubmit)="onSubmit(addModal, 'type')">
        <div class="form-group">
          <label class="control-label">Select Company</label>
          <select formControlName="selectedCompany" class="form-control">
            <option *ngFor="let company of productCompanies" value="{{company._id}}">{{company.company}}</option>
          </select>
        </div>
        <div class="form-group">
          <label class="control-label">Type</label>
          <input type="text" class="form-control" formControlName="pType" placeholder="Enter Product Type" />
        </div>
        <button class="btn btn-primary">Add Product Type</button>
      </form>
      <form *ngIf="view=='product'" [formGroup]="addProductForm" (ngSubmit)="onSubmit(addModal, 'product')">
        <div class="form-group">
          <label class="control-label">Name</label>
          <input type="text" class="form-control" formControlName="productName" placeholder="Enter Product Name" />
        </div>
        <div class="form-group">
          <label class="control-label">Type</label>
          <input type="text" class="form-control" formControlName="productType" placeholder="Enter Product Type" />
        </div>
        <div class="form-group">
          <label class="control-label">Company</label>
          <input type="text" class="form-control" formControlName="productCompanyName" placeholder="Enter Product Company" />
        </div>
        <div class="form-group">
          <label class="control-label">Quantity</label>
          <input type="text" class="form-control" formControlName="productQuantity" placeholder="Enter Product Quantity" />
        </div>
        <div class="form-group">
          <label class="control-label">MRP</label>
          <input type="text" class="form-control" formControlName="productMrp" placeholder="Enter Product MRP" />
        </div>
        <div class="form-group">
          <label class="control-label">Kcal</label>
          <input type="text" class="form-control" formControlName="productKcal" placeholder="Enter Product KCal" />
        </div>
        <button class="btn btn-primary">Add Product</button>
      </form>
      </modal-content>
  </modal>
  
  <modal #editModal [closeOnEscape]="false" [closeOnOutsideClick]="false">
      <modal-header>
        <h3>modal that cannot be simply closed</h3>
      </modal-header>
      <modal-content>
        <div *ngIf="view=='company'">
          <div class="form-group">
            <label class="control-label">Company{{selectedCompanyObj | json }}</label>
            <input type="text" class="form-control" [(ngModel)]="selectedCompanyObj.company" />
          </div>
          <button class="btn btn-primary" (click)="editCompany(editModal, selectedCompanyObj)">Edit Company</button>
        </div>
        <div *ngIf="view=='types'">
          <div class="form-group">
            <label class="control-label">Select Company</label>
            <select  [(ngModel)]="selectCompanyId" name="selectedCompany" class="form-control">
              <option *ngFor="let companyItem of productCompanies" value="{{companyItem._id}}">{{companyItem.company}}</option>
            </select>
          </div>
          <div class="form-group">
            <label class="control-label">Type</label>
            <input type="text" name="productType" class="form-control" [(ngModel)]="selectedTypeObj.type" />
          </div>
          <button class="btn btn-primary" (click)="editType(editModal, selectedTypeObj)">Edit Product Type</button>
        </div>
        <div *ngIf="view=='product'" >
          <div class="form-group">
            <label class="control-label">Name</label>
            <input type="text" class="form-control"  [(ngModel)]="selectedProductObj.name" />
          </div>
          <div class="form-group">
            <label class="control-label">Type</label>
            <input type="text" class="form-control" [(ngModel)]="selectedProductObj.type" />
          </div>
          <div class="form-group">
            <label class="control-label">Company</label>
            <input type="text" class="form-control"  [(ngModel)]="selectedProductObj.company" />
          </div>
          <div class="form-group">
            <label class="control-label">Quantity</label>
            <input type="text" class="form-control" [(ngModel)]="selectedProductObj.quantity" />
          </div>
          <div class="form-group">
            <label class="control-label">MRP</label>
            <input type="text" class="form-control" [(ngModel)]="selectedProductObj.price" />
          </div>
          <div class="form-group">
            <label class="control-label">Kcal</label>
            <input type="text" class="form-control" [(ngModel)]="selectedProductObj.kcal" />
          </div>
          <button class="btn btn-primary" (click)="editProduct(editModal, selectedProductObj)">Edit Product</button>
        </div>
        </modal-content>
    </modal>
  <div class="container-fluid content">
    <div *ngIf="view == 'company'">
      <div class="row">
        <button class="btn btn-primary" (click)="addModal.open()" style="margin:20px">Add Company</button>
      </div>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>No</th>
            <th>Company Name</th>
            <th>Edit/Delete</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pCompany of productCompanies, let i=index">
            <td>{{i+1}}</td>
            <td>{{pCompany.company}}</td>
            <td>
              <button (click)="editModal.open();selectedCompanyObj=pCompany" class="btn btn-success mr-20">Edit</button>
              <button (click)="deleteItem(pCompany._id, 'company')" class="btn btn-danger">Delete</button></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="view == 'types'">
      <div class="row">
        <button class="btn btn-primary" (click)="addModal.open()" style="margin:20px">Add Product Type</button>
      </div>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>No</th>
            <th>Product Company</th>
            <th>Product Type</th>
            <th>Edit/Delete</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pType of productTypes, let i=index">
            <td>{{i+1}}</td>
            <td>{{(pType.companies && pType.companies.length > 0) ? (pType.companies[0] && pType.companies[0].company ? pType.companies[0] && pType.companies[0].company : "") : ''}}</td>
            <td>{{pType.type}}</td>
            <td>
              <button (click)="editModal.open();selectedTypeObj=pType" class="btn btn-success mr-20">Edit</button>
              <button (click)="deleteItem(pType._id, 'type')" class="btn btn-danger">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="view == 'product'">
      <div class="row">
        <button (click)="addModal.open()" class="btn btn-primary" style="margin:20px">Add Product</button>
      </div>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>No</th>
            <th>Product Name</th>
            <th>Type</th>
            <th>Company</th>
            <th>Quantity</th>
            <th>MRP</th>
            <th>KCAL</th>
            <th>Edit/Delete</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of products, let i=index">
            <td>{{i+1}}</td>
            <td>{{product.name}}</td>
            <td>{{product.type}}</td>
            <td>{{product.company}}</td>
            <td>{{product.quantity}}</td>
            <td>{{product.price}}</td>
            <td>{{product.kcal}}</td>
            <td>
              <button (click)="editModal.open();selectedProductObj=product" class="btn btn-success mr-20">Edit</button>
              <button (click)="deleteItem(product._id, 'product')" class="btn btn-danger">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>